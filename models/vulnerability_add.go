package models

import (
	"gorm.io/gorm"
	"time"
)

type VulnerabilityAdd struct {
	gorm.Model
	Title                 string               `gorm:"not null"`          // Zafiyet başlığı
	Url                   string               `gorm:"not null"`          // URL
	Description           string               `gorm:"not null"`          // Zafiyet açıklaması (POC)
	ApplicationName       string               `gorm:"not null"`          // Uygulama adı
	Vendor                string               `gorm:"not null"`          // Şirket bilgisi
	ApplicationCategory   string               `gorm:"not null"`          // Uygulama kategorisi
	VulnerabilityCategory string               `gorm:"not null"`          // Zafiyet kategorisi
	SeverityLevel         string               `gorm:"not null"`          // Zafiyet seviyesi
	CvssScore             float64              `gorm:"type:numeric(3,1)"` // CVSS skoru
	Tags                  string               // Etiketler
	AddedBy               string               `gorm:"not null"`                   // Zafiyeti ekleyen kişi
	CreatedAt             time.Time            `gorm:"autoCreateTime"`             // Eklenme tarihi
	UpdatedAt             time.Time            `gorm:"autoUpdateTime"`             // Son güncellenme tarihi
	MediaFiles            []VulnerabilityMedia `gorm:"foreignKey:VulnerabilityID"` // Birden fazla medya dosyası ile ilişki
}
